<div class="text-center" id="banner">
  <p>
    SALES ASSOCIATES? COME GROW THE COMMUNITY, TELL AND RETAIN YOUR CLIENTS !
    <button type="button" class="btn-rounded btn-sm">SIGN UP</button>
  </p>
</div>

<div class="row" id="search-content">
  <div class="col-sm-4 store-list">
    <div class="row">
      <div class="col-xs-12 panel">
        <div class="panel-heading"><%= t(".filter")%></div>
        <div class="panel-body">
        <%= form_tag welcome_locate_path, class: "form-horizontal", method: :get do %>
            <div class="form-group form-group-sm">
              <%= label_tag :address,nil, class: "col-sm-2 control-label" %>
              <div class="col-sm-10">
                <%= text_field_tag :address, @address, class: "form-control"  %>
              </div>
            </div>
            <div class="form-group form-group-sm">
              <%= label_tag :brand,nil, class: "col-sm-2 control-label" %>
              <div class="col-sm-10">
                <%= select_tag :brand, options_for_select(Brand.all.collect{|brand| [brand.name, brand.id]}, @brand), class: "form-control", include_blank: true %>
              </div>
            </div>
            <div class="form-group form-group-sm">
              <%= label_tag :speciality,nil, class: "col-sm-2 control-label" %>
              <div class="col-sm-10">
                <%= select_tag :speciality, options_for_select(Brand.specialities, @speciality), class: "form-control", include_blank: true %>
              </div>
            </div>
            <div class="form-group form-group-sm">
              <div class="col-sm-offset-2 col-sm-10 text-right">
                <%= submit_tag :search, class: "btn btn-primary btn-sm "%>
                <a href="javascript:" class="btn btn-default btn-sm"><%= t(".hide")%></a>
              </div>
            </div>
        <% end %>
          </div>
      </div>
    </div>
    <div class="row ">
      <div class="col-xs-12 text-right">
        <nav>
            <%= will_paginate @stores, previous_label: "<<", next_label: ">>",class: "pagination-sm",
                              params: {address: @address, brand: @brand, speciality: @speciality},
                              renderer: BootstrapPagination::Rails %>
        </nav>
      </div>
    </div>
    <% @stores.each do |store| %>
        <div class="row store-area" data-id="<%= store.id %>">
          <div class="col-xs-12 bg-white">

            <div class="media">
              <div class="media-left">
                <a href="#">
                  <%= image_tag store.logo.url(:medium),
                                alt: store.brand.name,
                                class: "img-thumbnail media-object",
                                "data-content" => image_icon_data_content(store.logo.url(:medium), store.brand.name) %>
                </a>
              </div>
              <div class="media-body">
                <h4 class="media-heading"><%= link_to store.brand.name, "#" %></h4>
                <%= link_to store.brand.website, "http://#{store.brand.website}", target: "_blank" %> <br/>
                <%= raw address_format store, false %>
                <p>
                  <%= link_to "#{store.sales_associates.size} sales associated", store %>
                </p>
              </div>
            </div>


          </div>

        </div>
    <% end %>
  </div>

  <div class="col-sm-8">
    <div id="map" style="width: 100%; height: 550px;"></div>
  </div>
</div>
<script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBC9IaTnQh2ds8DAcLWL4zvU-dYBgrdQss&callback=loadLocateMap"/>
<script type="application/javascript">
    setStoresToMap(<%= raw @stores.to_json include: [:brand]%>);
</script>


<script type="application/javascript">
    $(document).ready(function () {
        $(".img-popover").popover({
            html: true,
            trigger: "hover",
            placement: "bottom"
        });
    });
</script>